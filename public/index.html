<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <title>HabitMind</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <h1>HabitMind ‚Äì –ó–≤–∏—á–∫–∏</h1>

  <div class="search-container">
    <input type="text" id="searchById" placeholder="–ü–æ—à—É–∫ –ø–æ ID" />
    <button onclick="searchById()">–ó–Ω–∞–π—Ç–∏</button>

    <input type="text" id="searchByName" placeholder="–ü–æ—à—É–∫ –ø–æ —ñ–º–µ–Ω—ñ" />
    <button onclick="searchByName()">–ó–Ω–∞–π—Ç–∏</button>

    <button onclick="loadAll()">–ü–æ–∫–∞–∑–∞—Ç–∏ –≤—Å—ñ</button>
  </div>

  <div id="habitList" class="card-container"></div>

  <script>
    const API_URL = 'http://localhost:3001/habits';

    async function loadAll() {
      const res = await fetch(API_URL);
      const data = await res.json();
      renderCards(data.data);
    }

    async function searchById() {
      const id = document.getElementById('searchById').value.trim();
      if (!id) return;

      const res = await fetch(`${API_URL}/${id}`);
      const data = await res.json();
      if (data?.data) {
        renderCards([data.data]);
      } else {
        renderCards([]);
      }
    }

    async function searchByName() {
      const name = document.getElementById('searchByName').value.trim();
      if (!name) return;

      const res = await fetch(`${API_URL}?name=${encodeURIComponent(name)}`);
      const data = await res.json();
      if (data?.data) {
        renderCards([data.data]);
      } else {
        renderCards([]);
      }
    }

    function renderCards(habits) {
      const container = document.getElementById('habitList');
      container.innerHTML = '';

      if (!habits.length) {
        container.innerHTML = `<p>–ù—ñ—á–æ–≥–æ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ</p>`;
        return;
      }

      habits.forEach(habit => {
        const card = document.createElement('div');
        card.className = 'habit-card';
        card.innerHTML = `
          <p><strong>ID:</strong> ${habit._id}</p>
          <p><strong>–Ü–º‚Äô—è:</strong> ${habit.name}</p>
          <p><strong>–ö—ñ–ª—å–∫—ñ—Å—Ç—å –¥–Ω—ñ–≤:</strong> ${habit.tasks?.length ?? 0}</p>
          <p><strong>–ó–∞–¥–∞—á—ñ:</strong></p>
          <ul>
            ${habit.tasks?.map(task => `
              <li>
                üìÖ ${task.date}, ‚Ññ${task.dayNumber},
                ${task.completed ? '‚úÖ' : '‚ùå'}
              </li>`).join('') ?? ''}
          </ul>
        `;
        container.appendChild(card);
      });
    }

    loadAll(); // –ü–æ–∫–∞–∑–∞—Ç–∏ –≤—Å—ñ –æ–¥—Ä–∞–∑—É
  </script>
</body>
</html>
